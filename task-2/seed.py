"""
Модуль для заповнення бази даних MongoDB тестовими даними про котів.
Використовує Faker для генерації імен та випадкового вибору характеристик.
"""


from faker import Faker
import random
from connect import get_database_connection
from typing import Dict, Any


# Ініціалізація Faker з українською локалізацією
fake = Faker('uk_UA')

# Список можливих характеристик котів
CAT_FEATURES = [
    "муркотливий", "грайливий", "лінивий", "активний", "ласкавий",
    "полохливий", "хоробрий", "розумний", "впертий", "цікавий",
    "дружелюбний", "незалежний", "енергійний", "спокійний", "гучний",
    "тихий", "обережний", "довірливий", "охайний", "неохайний",
    "соціальний", "відлюдкуватий", "ніжний", "агресивний", "терплячий",
    "примхливий", "грайливий з іграшками", "любить воду", "боїться води", "полює на мишей",
    "любить дітей", "уникає дітей", "територіальний", "мандрівний", "домашній",
    "любить інших котів", "не любить інших котів", "любить собак", "боїться собак",
    "любить лазити високо", "спить весь день", "активний вночі", "їсть все",
    "вибагливий до їжі", "любить сидіти на руках", "не любить руки", "любить гладитися",
    "дряпає меблі", "використовує лоток", "любить дивитися у вікно"
]


def generate_cat() -> Dict[str, Any]:
    """
    Генерує випадкові дані для одного кота.
    
    Returns:
        Dict[str, Any]: Словник з даними кота
    """
    # Вибираємо випадкову кількість характеристик (від 1 до 4)
    num_features = random.randint(1, 4)
    # Вибираємо випадкові характеристики без повторень
    features = random.sample(CAT_FEATURES, num_features)

    return {
        "name": fake.first_name(),  # Використовуємо імена людей як імена котів
        "age": random.randint(1, 15),
        "features": features
    }


def seed_database(num_cats: int = 10) -> None:
    """
    Заповнює базу даних випадковими даними про котів.
    
    Args:
        num_cats (int): Кількість котів для створення
    """
    try:
        # Отримуємо з'єднання з базою даних
        client = get_database_connection()
        if client:
            db = client["cats_db"]
            collection = db["cats"]

            # Очищення колекції перед додаванням нових даних
            collection.drop()

            # Генерація та додавання котів
            cats = [generate_cat() for _ in range(num_cats)]
            collection.insert_many(cats)

            print(f"Додано {num_cats} котів до бази даних")

            # Виведення прикладу доданих даних
            print("\nПриклад доданих даних:")
            for cat in collection.find().limit(3):
                print(f"\nІм'я: {cat['name']}")
                print(f"Вік: {cat['age']}")
                print("Характеристики:", ", ".join(cat['features']))

    except Exception as e:
        print(f"Помилка при заповненні бази даних: {e}")


if __name__ == "__main__":
    seed_database(20)  # Створюємо 20 випадкових котів
